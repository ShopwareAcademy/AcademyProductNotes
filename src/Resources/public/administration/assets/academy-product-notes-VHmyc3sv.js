const i=`{% block sw_product_detail_content_tabs_additional %} {% parent %} <sw-tabs-item :route="{ name: 'sw.product.detail.productNotes', params: { id: $route.params.id } }" > {{ $t('academy-product-notes.detail.tabNotes') }} </sw-tabs-item> {% endblock %}`,{Component:d}=Shopware;d.override("sw-product-detail",{template:i,computed:{productCriteria(){const t=this.$super("productCriteria");return t.addAssociation("academyProductNotes"),t}}});const l=`<sw-card :title="$t('academy-product-notes.detail.cardTitle')" :isLoading="isLoading"> <template #toolbar> <sw-button variant="primary" size="small" @click="onAddNote"> {{ $t('academy-product-notes.detail.buttonAddNote') }} </sw-button> </template> <template #grid> <sw-data-grid v-if="notes.length > 0" :dataSource="notes" :columns="noteColumns" :showSelection="false" :isLoading="isLoading"> <template #column-note="{ item }"> <div class="academy-note-preview"> {{ item.note.length > 100 ? item.note.substring(0, 100) + '...' : item.note }} </div> </template> <template #column-solved="{ item }"> <sw-data-grid-column-boolean :value="item.solved" :is-inline-edit="false" /> </template> <template #column-createdAt="{ item }"> {{ dateFilter(item.createdAt, { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' }) }} </template> <template #actions="{ item }"> <sw-context-menu-item @click="onEditNote(item)"> {{ $t('academy-product-notes.detail.buttonEdit') }} </sw-context-menu-item> <sw-context-menu-item variant="danger" @click="onDeleteNote(item)"> {{ $t('academy-product-notes.detail.buttonDelete') }} </sw-context-menu-item> </template> </sw-data-grid> <sw-empty-state v-else :title="$t('academy-product-notes.detail.messageNoNotes')"> </sw-empty-state> </template> <academy-product-note-modal v-if="showModal" :note="currentNote" @save="onSaveNote" @close="onCloseModal"> </academy-product-note-modal> <sw-modal v-if="showDeleteModal" :title="$t('academy-product-notes.detail.buttonDelete')" variant="small" @modal-close="onCancelDelete"> <p>{{ $t('academy-product-notes.detail.messageDeleteConfirm') }}</p> <template #modal-footer> <mt-button size="small" variant="secondary" @click="onCancelDelete" > {{ $t('academy-product-notes.detail.buttonCancel') }} </mt-button> <mt-button variant="critical" size="small" @click="onConfirmDelete" > {{ $t('academy-product-notes.detail.buttonDelete') }} </mt-button> </template> </sw-modal> </sw-card>`,{Context:e,Component:n,Mixin:r,Filter:c}=Shopware,{Criteria:o}=Shopware.Data;n.register("sw-product-detail-notes",{template:l,inject:["repositoryFactory"],mixins:[r.getByName("notification")],data(){return{notes:[],isLoading:!1,showModal:!1,currentNote:null,showDeleteModal:!1,noteToDelete:null}},computed:{productId(){return this.$route.params.id},dateFilter(){return c.getByName("date")},noteRepository(){return this.repositoryFactory.create("academy_product_note")},noteColumns(){return[{property:"note",label:this.$t("academy-product-notes.detail.columnNote"),rawData:!0},{property:"solved",label:this.$t("academy-product-notes.detail.columnSolved"),rawData:!0},{property:"createdAt",label:this.$t("academy-product-notes.detail.columnCreatedAt"),rawData:!0}]}},created(){this.loadNotes()},methods:{loadNotes(){this.isLoading=!0;const t=new o;t.addFilter(o.equals("productId",this.productId)),t.addSorting(o.sort("createdAt","DESC")),this.noteRepository.search(t,e.api).then(s=>{this.notes=s}).finally(()=>{this.isLoading=!1})},onAddNote(){this.currentNote=this.noteRepository.create(e.api),this.currentNote.productId=this.productId,this.currentNote.solved=!1,this.showModal=!0},onEditNote(t){this.currentNote=t,this.showModal=!0},onDeleteNote(t){this.noteToDelete=t,this.showDeleteModal=!0},onConfirmDelete(){this.noteToDelete&&this.noteRepository.delete(this.noteToDelete.id,e.api).then(()=>{this.createNotificationSuccess({message:this.$t("academy-product-notes.detail.messageDeleteSuccess")}),this.loadNotes()}).catch(()=>{this.createNotificationError({message:this.$t("academy-product-notes.detail.messageError")})}).finally(()=>{this.showDeleteModal=!1,this.noteToDelete=null})},onCancelDelete(){this.showDeleteModal=!1,this.noteToDelete=null},onSaveNote(){this.noteRepository.save(this.currentNote,e.api).then(()=>{this.createNotificationSuccess({message:this.$t("academy-product-notes.detail.messageSaveSuccess")}),this.showModal=!1,this.loadNotes()}).catch(()=>{this.createNotificationError({message:this.$t("academy-product-notes.detail.messageError")})})},onCloseModal(){this.showModal=!1,this.currentNote=null}}});const a=Shopware.Module.getModuleRegistry().get("sw-product");a&&a.routes.get("sw.product.detail").children.push({name:"sw.product.detail.productNotes",path:"/sw/product/detail/:id?/product-notes",component:"sw-product-detail-notes",meta:{parentPath:"sw.product.index",privilege:"product.viewer"}});const m=`<sw-modal :title="modalTitle" @modal-close="onClose"> <template #body> <div class="academy-product-note-modal__content"> <sw-container columns="1fr" gap="20px"> <sw-textarea-field v-model="note.note" :label="$t('academy-product-notes.detail.labelNote')" :placeholder="$t('academy-product-notes.detail.placeholderNote')" required> </sw-textarea-field> <sw-checkbox-field v-model="note.solved" :label="$t('academy-product-notes.detail.labelSolved')"> </sw-checkbox-field> </sw-container> </div> </template> <template #modal-footer> <sw-button size="small" @click="onClose"> {{ $t('academy-product-notes.detail.buttonCancel') }} </sw-button> <sw-button variant="primary" size="small" @click="onSave"> {{ $t('academy-product-notes.detail.buttonSave') }} </sw-button> </template> </sw-modal>`,{Component:u}=Shopware;u.register("academy-product-note-modal",{template:m,props:{note:{type:Object,required:!0}},computed:{modalTitle(){return this.note.isNew()?this.$t("academy-product-notes.detail.buttonAddNote"):this.$t("academy-product-notes.detail.buttonEdit")}},methods:{onSave(){this.$emit("save")},onClose(){this.$emit("close")}}});
//# sourceMappingURL=academy-product-notes-VHmyc3sv.js.map
