{"version":3,"file":"academy-product-notes-VHmyc3sv.js","sources":["../../../app/administration/src/module/sw-product/page/sw-product-detail/sw-product-detail.html.twig","../../../app/administration/src/module/sw-product/page/sw-product-detail/index.js","../../../app/administration/src/module/sw-product/page/sw-product-detail-notes/sw-product-detail-notes.html.twig","../../../app/administration/src/module/sw-product/page/sw-product-detail-notes/index.js","../../../app/administration/src/module/sw-product/index.js","../../../app/administration/src/component/academy-product-note-modal/academy-product-note-modal.html.twig","../../../app/administration/src/component/academy-product-note-modal/index.js"],"sourcesContent":["{% block sw_product_detail_content_tabs_additional %}\n    {% parent %}\n\n    <sw-tabs-item\n            :route=\"{\n                name: 'sw.product.detail.productNotes',\n                params: {\n                    id: $route.params.id\n                }\n            }\"\n    >\n        {{ $t('academy-product-notes.detail.tabNotes') }}\n    </sw-tabs-item>\n\n{% endblock %}\n","import template from './sw-product-detail.html.twig';\n\nconst { Component } = Shopware;\n\nComponent.override('sw-product-detail', {\n    template,\n\n    computed: {\n        productCriteria() {\n            const criteria = this.$super('productCriteria');\n            criteria.addAssociation('academyProductNotes');\n            return criteria;\n        }\n    }\n}); ","<sw-card :title=\"$t('academy-product-notes.detail.cardTitle')\" :isLoading=\"isLoading\">\n    <template #toolbar>\n        <sw-button \n            variant=\"primary\" \n            size=\"small\"\n            @click=\"onAddNote\">\n            {{ $t('academy-product-notes.detail.buttonAddNote') }}\n        </sw-button>\n    </template>\n\n    <template #grid>\n        <sw-data-grid\n            v-if=\"notes.length > 0\"\n            :dataSource=\"notes\"\n            :columns=\"noteColumns\"\n            :showSelection=\"false\"\n            :isLoading=\"isLoading\">\n\n            <template #column-note=\"{ item }\">\n                <div class=\"academy-note-preview\">\n                    {{ item.note.length > 100 ? item.note.substring(0, 100) + '...' : item.note }}\n                </div>\n            </template>\n\n            <template #column-solved=\"{ item }\">\n                <sw-data-grid-column-boolean\n                    :value=\"item.solved\"\n                    :is-inline-edit=\"false\"\n                />\n            </template>\n\n            <template #column-createdAt=\"{ item }\">\n                {{ dateFilter(item.createdAt, { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' }) }}\n            </template>\n\n            <template #actions=\"{ item }\">\n                <sw-context-menu-item @click=\"onEditNote(item)\">\n                    {{ $t('academy-product-notes.detail.buttonEdit') }}\n                </sw-context-menu-item>\n                <sw-context-menu-item \n                    variant=\"danger\"\n                    @click=\"onDeleteNote(item)\">\n                    {{ $t('academy-product-notes.detail.buttonDelete') }}\n                </sw-context-menu-item>\n            </template>\n        </sw-data-grid>\n\n        <sw-empty-state\n            v-else\n            :title=\"$t('academy-product-notes.detail.messageNoNotes')\">\n        </sw-empty-state>\n    </template>\n\n    <!-- Note Modal -->\n    <academy-product-note-modal\n        v-if=\"showModal\"\n        :note=\"currentNote\"\n        @save=\"onSaveNote\"\n        @close=\"onCloseModal\">\n    </academy-product-note-modal>\n\n    <!-- Delete Modal -->\n    <sw-modal\n        v-if=\"showDeleteModal\"\n        :title=\"$t('academy-product-notes.detail.buttonDelete')\"\n        variant=\"small\"\n        @modal-close=\"onCancelDelete\">\n        <p>{{ $t('academy-product-notes.detail.messageDeleteConfirm') }}</p>\n        \n        <template #modal-footer>\n            <mt-button\n                size=\"small\"\n                variant=\"secondary\"\n                @click=\"onCancelDelete\"\n            >\n                {{ $t('academy-product-notes.detail.buttonCancel') }}\n            </mt-button>\n            <mt-button\n                variant=\"critical\"\n                size=\"small\"\n                @click=\"onConfirmDelete\"\n            >\n                {{ $t('academy-product-notes.detail.buttonDelete') }}\n            </mt-button>\n        </template>\n    </sw-modal>\n</sw-card> ","import template from './sw-product-detail-notes.html.twig';\n\nconst { Context, Component, Mixin, Filter } = Shopware;\nconst { Criteria } = Shopware.Data;\n\nComponent.register('sw-product-detail-notes', {\n    template,\n\n    inject: ['repositoryFactory'],\n\n    mixins: [\n        Mixin.getByName('notification')\n    ],\n\n    data() {\n        return {\n            notes: [],\n            isLoading: false,\n            showModal: false,\n            currentNote: null,\n            showDeleteModal: false,\n            noteToDelete: null\n        };\n    },\n\n    computed: {\n        productId() {\n            return this.$route.params.id;\n        },\n\n        dateFilter() {\n            return Filter.getByName('date');\n        },\n\n        noteRepository() {\n            return this.repositoryFactory.create('academy_product_note');\n        },\n\n        noteColumns() {\n            return [\n                {\n                    property: 'note',\n                    label: this.$t('academy-product-notes.detail.columnNote'),\n                    rawData: true\n                },\n                {\n                    property: 'solved',\n                    label: this.$t('academy-product-notes.detail.columnSolved'),\n                    rawData: true\n                },\n                {\n                    property: 'createdAt',\n                    label: this.$t('academy-product-notes.detail.columnCreatedAt'),\n                    rawData: true\n                }\n            ];\n        }\n    },\n\n    created() {\n        this.loadNotes();\n    },\n\n    methods: {\n        loadNotes() {\n            this.isLoading = true;\n            const criteria = new Criteria();\n            criteria.addFilter(Criteria.equals('productId', this.productId));\n            criteria.addSorting(Criteria.sort('createdAt', 'DESC'));\n\n            this.noteRepository.search(criteria, Context.api)\n                .then((result) => {\n                    this.notes = result;\n                })\n                .finally(() => {\n                    this.isLoading = false;\n                });\n        },\n\n        onAddNote() {\n            this.currentNote = this.noteRepository.create(Context.api);\n            this.currentNote.productId = this.productId;\n            this.currentNote.solved = false;\n            this.showModal = true;\n        },\n\n        onEditNote(note) {\n            this.currentNote = note;\n            this.showModal = true;\n        },\n\n        onDeleteNote(note) {\n            this.noteToDelete = note;\n            this.showDeleteModal = true;\n        },\n\n        onConfirmDelete() {\n            if (!this.noteToDelete) {\n                return;\n            }\n\n            this.noteRepository.delete(this.noteToDelete.id, Context.api)\n                .then(() => {\n                    this.createNotificationSuccess({\n                        message: this.$t('academy-product-notes.detail.messageDeleteSuccess')\n                    });\n                    this.loadNotes();\n                })\n                .catch(() => {\n                    this.createNotificationError({\n                        message: this.$t('academy-product-notes.detail.messageError')\n                    });\n                })\n                .finally(() => {\n                    this.showDeleteModal = false;\n                    this.noteToDelete = null;\n                });\n        },\n\n        onCancelDelete() {\n            this.showDeleteModal = false;\n            this.noteToDelete = null;\n        },\n\n        onSaveNote() {\n            this.noteRepository.save(this.currentNote, Context.api)\n                .then(() => {\n                    this.createNotificationSuccess({\n                        message: this.$t('academy-product-notes.detail.messageSaveSuccess')\n                    });\n                    this.showModal = false;\n                    this.loadNotes();\n                })\n                .catch(() => {\n                    this.createNotificationError({\n                        message: this.$t('academy-product-notes.detail.messageError')\n                    });\n                });\n        },\n\n        onCloseModal() {\n            this.showModal = false;\n            this.currentNote = null;\n        }\n    }\n}); ","import './page/sw-product-detail';\nimport './page/sw-product-detail-notes';\n\nconst productModule = Shopware.Module.getModuleRegistry().get('sw-product');\n\nif (productModule) {\n    productModule.routes.get('sw.product.detail').children.push({\n        name: 'sw.product.detail.productNotes',\n        path: '/sw/product/detail/:id?/product-notes',\n        component: 'sw-product-detail-notes',\n        meta: {\n            parentPath: 'sw.product.index',\n            privilege: 'product.viewer',\n        },\n    });\n}","<sw-modal\n    :title=\"modalTitle\"\n    @modal-close=\"onClose\">\n\n    <template #body>\n        <div class=\"academy-product-note-modal__content\">\n            <sw-container columns=\"1fr\" gap=\"20px\">\n                <sw-textarea-field\n                    v-model=\"note.note\"\n                    :label=\"$t('academy-product-notes.detail.labelNote')\"\n                    :placeholder=\"$t('academy-product-notes.detail.placeholderNote')\"\n                    required>\n                </sw-textarea-field>\n\n                <sw-checkbox-field\n                    v-model=\"note.solved\"\n                    :label=\"$t('academy-product-notes.detail.labelSolved')\">\n                </sw-checkbox-field>\n            </sw-container>\n        </div>\n    </template>\n\n    <template #modal-footer>\n        <sw-button \n            size=\"small\"\n            @click=\"onClose\">\n            {{ $t('academy-product-notes.detail.buttonCancel') }}\n        </sw-button>\n        <sw-button \n            variant=\"primary\" \n            size=\"small\"\n            @click=\"onSave\">\n            {{ $t('academy-product-notes.detail.buttonSave') }}\n        </sw-button>\n    </template>\n</sw-modal> ","import template from './academy-product-note-modal.html.twig';\nimport './academy-product-note-modal.scss';\n\nconst { Component } = Shopware;\n\nComponent.register('academy-product-note-modal', {\n    template,\n\n    props: {\n        note: {\n            type: Object,\n            required: true\n        }\n    },\n\n    computed: {\n        modalTitle() {\n            return this.note.isNew() \n                ? this.$t('academy-product-notes.detail.buttonAddNote')\n                : this.$t('academy-product-notes.detail.buttonEdit');\n        }\n    },\n\n    methods: {\n        onSave() {\n            this.$emit('save');\n        },\n\n        onClose() {\n            this.$emit('close');\n        }\n    }\n}); "],"names":["template$2","Component","template","criteria","template$1","Context","Mixin","Filter","Criteria","result","note","productModule"],"mappings":"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"}